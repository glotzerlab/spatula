import conftest
import coxeter
import numpy as np
import pytest

cutoff=0.99

def get_pyramid(n: int) -> np.ndarray:
    base = coxeter.families.RegularNGonFamily().get_shape(n).vertices
    # Need to offset polygon to make dihedral order low for testing.
    return (
        f"Pyramid({n})",
        np.concatenate((base - np.array([0.0, 0.0, -0.5]), [[0.0, 0.0, 3.0]])),
    )


def get_bipyramid(n: int) -> np.ndarray:
    base = coxeter.families.RegularNGonFamily().get_shape(n).vertices
    return (
        f"Bipyramid({n})",
        np.concatenate((base, [[0.0, 0.0, 3.0], [0.0, 0.0, -3.0]])),
    )


def parse_shape_values(
    a: str | tuple[str, np.ndarray],
) -> tuple[str, np.ndarray]:
    if isinstance(a, tuple):
        return a
    family, shape = a.split(".")
    if shape.isdigit():
        shape = int(shape)

    vertices = getattr(coxeter.families, family).get_shape(shape).vertices
    return shape, vertices


def _id_func(value):
    if isinstance(value, str):
        return value
    elif isinstance(value, int):
        return f"NGon{value}"
    return ""


# TODO: Add shapes for T_h which does not include tetrahedron
shape_symmetries = {
    "O": ["PlatonicFamily.Octahedron", "PlatonicFamily.Cube"],
    "Oh": ["PlatonicFamily.Octahedron", "PlatonicFamily.Cube"],
    "T": ["PlatonicFamily.Tetrahedron"],
    "I": ["PlatonicFamily.Icosahedron"],
    "Ih": ["PlatonicFamily.Icosahedron"],
}
shape_symmetries.update({"C2": ["RegularNGonFamily.4"]})
shape_symmetries.update({f"C{i}": [get_pyramid(i)] for i in range(3, 13)})
shape_symmetries.update({"D2": ["RegularNGonFamily.4"]})
shape_symmetries.update({f"D{i}": [get_bipyramid(i)] for i in range(3, 13)})

non_shape_symmetries = {
    "O": ["PlatonicFamily.Tetrahedron", "PlatonicFamily.Icosahedron"],
    "Oh": ["PlatonicFamily.Tetrahedron", "PlatonicFamily.Icosahedron"],
    "T": [get_pyramid(5), get_bipyramid(5)],
    "I": ["PlatonicFamily.Octahedron"],
    "Ih": ["PlatonicFamily.Octahedron"],
}
# Symmetries are carefully chosen here as due to rotations and partial ordering
# meeting the threshold can be difficult here.
cyclic_non_symmetry = {
    2: 3,
    3: 4,
    4: 5,
    5: 3,
    6: 3,
    7: 4,
    8: 3,
    9: 4,
    10: 4,
    11: 5,
    12: 5,
}
non_shape_symmetries.update(
    {f"C{i}": [f"RegularNGonFamily.{cyclic_non_symmetry[i]}"] for i in range(3, 13)}
)
non_shape_symmetries.update({f"D{i}": [get_pyramid(i)] for i in range(3, 13)})
non_shape_symmetries.update(
    {f"D{i}": [get_bipyramid(cyclic_non_symmetry[i])] for i in range(3, 13)}
)


@pytest.mark.parametrize(
    "symmetry, shape, vertices",
    (
        (sym, shape, vertices)
        for sym, shapes in shape_symmetries.items()
        for shape, vertices in map(parse_shape_values, shapes)
    ),
    ids=_id_func,
)
def test_symmetries(symmetry, shape, vertices):
    conftest.check_symmetry(symmetry=symmetry, vertices=vertices, threshold=cutoff)


@pytest.mark.parametrize(
    "symmetry, shape, vertices",
    (
        (sym, shape, vertices)
        for sym, shapes in non_shape_symmetries.items()
        for shape, vertices in map(parse_shape_values, shapes)
    ),
    ids=_id_func,
)
def test_no_symmetries(symmetry, shape, vertices):
    conftest.check_symmetry(
        symmetry=symmetry, vertices=vertices, threshold=0.8, has_symmetry=False
    )


###################################################
# TODO: add Dnd
#The vertices found in this dictionary for all these shapes were taken from http://dmccooey.com/polyhedra/Simplest.html
shapes_data = {
    "C1": {
        "vertices": [
            [1.56922900989136486079919529624, 0.127344173132779220661025515340, -0.594246684979361531856095101193],
            [0.0544154317961383030163066010436, -0.947594490792603122917402692721, -0.594246684979361531856095101193],
            [-1.67017858435830105053903440232, 0.0, -0.594246684979361531856095101193],
            [-0.0213946139374397854092095434663, 0.905939944266888642915620773436, -0.594246684979361531856095101193],
            [0.408714532008138679156653441174, -0.984198346940939589795611220376, 0.362199783826854559024170380756],
            [-0.0120908032100600645529433979780, 1.16488491635665498242827880542, 0.788799869882532888666060905952],
            [-0.384754129324100147766981384357, -0.433371335880031688698557665178, 1.05712424949451132235936641797]
        ]
    },
    "Ci": {
        "vertices": [
            [1.189207115002721, 0.0, 1.0], [-1.189207115002721, 0.0, -1.0],
            [-0.49258571550470803, 0.0, 1.0], [0.49258571550470803, 0.0, -1.0],
            [-0.8408964152537145, 0.49258571550470803, 0.41421356237309503],
            [0.8408964152537145, -0.49258571550470803, -0.41421356237309503],
            [-0.3483106997490065, -1.189207115002721, 0.41421356237309503],
            [0.3483106997490065, 1.189207115002721, -0.41421356237309503],
            [0.5946035575013605, -0.8408964152537145, 0.0],
            [-0.5946035575013605, 0.8408964152537145, 0.0]
        ]
    },
    "Cs": {
        "vertices": [
            [1.3737233664112654, -0.553529398617591, 0.8328296373605156],
            [-1.3737233664112654, -0.553529398617591, 0.8328296373605156],
            [0.5049089371450616, -0.553529398617591, -0.8328296373605156],
            [-0.5049089371450616, -0.553529398617591, -0.8328296373605156],
            [0.0, 0.5401563613890422, 0.9252962109065457],
            [0.0, 2.2892449735263116, -1.258960428697956]
        ]
    },
    "C2": {
        "vertices": [
            [0.47895290007454705, 0.6092375000865723, 1.0],
            [-0.47895290007454705, -0.6092375000865723, 1.0],
            [1.5950044824476632, 0.0, -1.0],
            [-1.5950044824476632, 0.0, -1.0],
            [0.0, 1.13589310962197, -0.11972592295680519],
            [0.0, -1.13589310962197, -0.11972592295680519]
        ]
    },
    "C3": {
        "vertices": [
            [0.09721493414474791, 0.8917128617235874, 0.8937837306664239],
            [-0.8208534582063212, -0.3616658282652108, 0.8937837306664239],
            [0.7236385240615733, -0.5300470334583767, 0.8937837306664239],
            [1.222667862618902, 0.0, -0.7913727468328255],
            [-0.611333931309451, 1.058861429418791, -0.7913727468328255],
            [-0.611333931309451, -1.058861429418791, -0.7913727468328255],
            [-1.0367052338386331, 0.0, -0.08116122495760766],
            [0.5183526169193166, -0.8978130687405432, -0.08116122495760766],
            [0.5183526169193166, 0.8978130687405432, -0.08116122495760766]
        ]
    },
    "C4": {
        "vertices": [
            [0.9020768831634525, 0.28480944998815594, 0.7433508169295151],
            [-0.9020768831634525, -0.28480944998815594, 0.7433508169295151],
            [0.28480944998815594, -0.9020768831634525, 0.7433508169295151],
            [-0.28480944998815594, 0.9020768831634525, 0.7433508169295151],
            [0.7863247436800825, 0.7863247436800825, -0.6178134002079047],
            [0.7863247436800825, -0.7863247436800825, -0.6178134002079047],
            [-0.7863247436800825, 0.7863247436800825, -0.6178134002079047],
            [-0.7863247436800825, -0.7863247436800825, -0.6178134002079047],
            [1.017425061294311, 0.0, -0.0692776715108155],
            [-1.017425061294311, 0.0, -0.0692776715108155],
            [0.0, 1.017425061294311, -0.0692776715108155],
            [0.0, -1.017425061294311, -0.0692776715108155]
        ]
    },
    "C2h": {
        "vertices": [
            [0.0, 0.0, 1.618033988749895],
            [0.0, 0.0, -1.618033988749895],
            [0.0, 0.9717365435132913, 0.38196601125010515],
            [0.0, -0.9717365435132913, -0.38196601125010515],
            [1.0, 0.7861513777574233, 0.0],
            [1.0, -0.7861513777574233, 0.0],
            [-1.0, 0.7861513777574233, 0.0],
            [-1.0, -0.7861513777574233, 0.0]
        ]
    },
    "C2v": {
        "vertices": [
            [0.0, 1.0745841941261967, 1.0],
            [0.0, -1.0745841941261967, 1.0],
            [1.6677004630016656, 0.0, -0.5519907530258161],
            [-1.6677004630016656, 0.0, -0.5519907530258161],
            [0.0, 0.9628473112416752, -0.5519907530258161],
            [0.0, -0.9628473112416752, -0.5519907530258161]
        ]
    },
    "C3v": {
        "vertices": [
            [1.0, -1.0, 1.0],
            [-1.0, 1.0, 1.0],
            [1.0, 1.0, -1.0],
            [-1.0, -0.3333333333333333, -0.3333333333333333],
            [-0.3333333333333333, -1.0, -0.3333333333333333],
            [-0.3333333333333333, -0.3333333333333333, -1.0],
            [0.6, 0.6, 0.6]
        ]
    },
    "C4v": {
        "vertices": [
            [1.2871885058111652, 0.0, -0.41421356237309503],
            [-1.2871885058111652, 0.0, -0.41421356237309503],
            [0.0, 1.2871885058111652, -0.41421356237309503],
            [0.0, -1.2871885058111652, -0.41421356237309503],
            [0.0, 0.0, 2.414213562373095]
        ]
    },
    "C5v": {
        "vertices": [
            [2.0581710272714924, 2.0581710272714924, -1.0],
            [-0.48586827175664565, -0.48586827175664565, -1.0],
            [0.48586827175664565, -0.48586827175664565, 1.0],
            [-0.48586827175664565, 0.48586827175664565, 1.0],
            [0.48586827175664565, -1.086434483758201, -0.2360679774997897],
            [-1.086434483758201, 0.48586827175664565, -0.2360679774997897]
        ]
    },
    "C6v": {
        "vertices": [
            [0.0, 0.0, 3.732050807568877],
            [1.1124766546018, 0.0, -0.2679491924311227],
            [-1.1124766546018, 0.0, -0.2679491924311227],
            [0.5562383273009, 0.9634330440022851, -0.2679491924311227],
            [0.5562383273009, -0.9634330440022851, -0.2679491924311227],
            [-0.5562383273009, 0.9634330440022851, -0.2679491924311227],
            [-0.5562383273009, -0.9634330440022851, -0.2679491924311227]
        ]
    },
    "C7v": {
        "vertices": [
            [3.016261705993797, 3.016261705993797, -1.0],
            [-0.3315362184961733, -0.3315362184961733, -1.0],
            [0.3315362184961733, -0.3315362184961733, 1.0],
            [-0.3315362184961733, 0.3315362184961733, 1.0],
            [0.3315362184961733, -0.8632790272924121, -0.6038754716096765],
            [-0.8632790272924121, 0.3315362184961733, -0.6038754716096765],
            [0.6266312144166262, -0.8632790272924121, 0.2862082642155811],
            [-0.8632790272924121, 0.6266312144166262, 0.2862082642155811]
        ]
    },
    "C8v": {
        "vertices": [
            [0.0, 0.0, 5.027339492125848],
            [1.0607630605786609, 0.0, -0.198912367379658],
            [-1.0607630605786609, 0.0, -0.198912367379658],
            [0.0, 1.0607630605786609, -0.198912367379658],
            [0.0, -1.0607630605786609, -0.198912367379658],
            [0.7500727533673677, 0.7500727533673677, -0.198912367379658],
            [0.7500727533673677, -0.7500727533673677, -0.198912367379658],
            [-0.7500727533673677, 0.7500727533673677, -0.198912367379658],
            [-0.7500727533673677, -0.7500727533673677, -0.198912367379658]
        ]
    },
    "C9v": {
        "vertices": [
            [3.947368584102982, 3.947368584102982, -1.0],
            [-0.25333332286912463, -0.25333332286912463, -1.0],
            [0.25333332286912463, -0.25333332286912463, 1.0],
            [-0.25333332286912463, 0.25333332286912463, 1.0],
            [0.25333332286912463, -0.6988884935280371, -0.7587704831436335],
            [-0.6988884935280371, 0.25333332286912463, -0.7587704831436335],
            [0.5840364891732476, -0.6988884935280371, 0.5466368061886451],
            [-0.6988884935280371, 0.5840364891732476, 0.5466368061886451],
            [0.5840364891732476, -0.8748519729621633, -0.14795590447907633],
            [-0.8748519729621633, 0.5840364891732476, -0.14795590447907633]
        ]
    },
    "C10v": {
        "vertices": [
            [0.0, 0.0, 6.313751514675043],
            [1.038190164439838, 0.0, -0.1583844403245363],
            [-1.038190164439838, 0.0, -0.1583844403245363],
            [0.8399134864247502, 0.6102328677328344, -0.1583844403245363],
            [0.8399134864247502, -0.6102328677328344, -0.1583844403245363],
            [-0.8399134864247502, 0.6102328677328344, -0.1583844403245363],
            [-0.8399134864247502, -0.6102328677328344, -0.1583844403245363],
            [0.32081840420483115, 0.987377521044045, -0.1583844403245363],
            [0.32081840420483115, -0.987377521044045, -0.1583844403245363],
            [-0.32081840420483115, 0.987377521044045, -0.1583844403245363],
            [-0.32081840420483115, -0.987377521044045, -0.1583844403245363]
        ]
    },
    "C11v": {
        "vertices": [
            [4.866936925762868, 4.866936925762868, -1.0],
            [-0.2054680418615154, -0.2054680418615154, -1.0],
            [0.2054680418615154, -0.2054680418615154, 1.0],
            [-0.2054680418615154, 0.2054680418615154, 1.0],
            [0.2054680418615154, -0.5831125280122984, -0.8379718944579896],
            [-0.5831125280122984, 0.2054680418615154, -0.8379718944579896],
            [0.5192264201103518, -0.5831125280122984, 0.6890703424087455],
            [-0.5831125280122984, 0.5192264201103518, 0.6890703424087455],
            [0.5192264201103518, -0.8075659605463921, -0.40333035650565957],
            [-0.8075659605463921, 0.5192264201103518, -0.40333035650565957],
            [0.6361910247017525, -0.8075659605463921, 0.16592899658748098],
            [-0.8075659605463921, 0.6361910247017525, 0.16592899658748098]
        ]
    },
    "S4": {
        "vertices": [
            [0.0, 0.0, 1.176614197732676],
            [0.0, 0.0, -1.176614197732676],
            [0.36031346070627496, 0.6612064329575712, 0.7097370431606547],
            [-0.36031346070627496, -0.6612064329575712, 0.7097370431606547],
            [0.6612064329575712, -0.36031346070627496, -0.7097370431606547],
            [-0.6612064329575712, 0.36031346070627496, -0.7097370431606547],
            [1.4142135623730951, 0.0, 0.2997778728622828],
            [-1.4142135623730951, 0.0, 0.2997778728622828],
            [0.0, 1.4142135623730951, -0.2997778728622828],
            [0.0, -1.4142135623730951, -0.2997778728622828]
        ]
    },
    "S6": {
        "vertices": [
            [0.0, 0.0, 1.5784071969468327],
            [0.0, 0.0, -1.5784071969468327],
            [-0.8364985495055208, -0.31981873553238954, 0.48474417163591016],
            [0.8364985495055208, 0.31981873553238954, -0.48474417163591016],
            [0.6952204243300266, -0.5645196263344211, 0.48474417163591016],
            [-0.6952204243300266, 0.5645196263344211, -0.48474417163591016],
            [0.14127812517549415, 0.8843383618668106, 0.48474417163591016],
            [-0.14127812517549415, -0.8843383618668106, -0.48474417163591016],
            [1.1547005383792515, 0.0, 0.16826806462758645],
            [-1.1547005383792515, 0.0, -0.16826806462758645],
            [-0.5773502691896257, 1.0, 0.16826806462758645],
            [0.5773502691896257, 1.0, -0.16826806462758645],
            [-0.5773502691896257, -1.0, 0.16826806462758645],
            [0.5773502691896257, -1.0, -0.16826806462758645]
        ]
    },
    "D2": {
        "vertices": [
            [0.0, 0.0, 1.2078882314892923],
            [0.0, 0.0, -1.2078882314892923],
            [0.20678349452781558, -0.8278911690090963, 0.6297684119865748],
            [0.20678349452781558, 0.8278911690090963, -0.6297684119865748],
            [-0.20678349452781558, 0.8278911690090963, 0.6297684119865748],
            [-0.20678349452781558, -0.8278911690090963, -0.6297684119865748],
            [1.0, 0.8278911690090963, 0.3283484699963385],
            [1.0, -0.8278911690090963, -0.3283484699963385],
            [-1.0, -0.8278911690090963, 0.3283484699963385],
            [-1.0, 0.8278911690090963, -0.3283484699963385]
        ]
    },
    "D3": {
        "vertices": [
            [0.0, 0.0, 1.1491020339707478],
            [0.21163171332200198, 0.24385641862467136, -1.0],
            [-0.21163171332200198, -0.24385641862467136, -1.0],
            [0.21163171332200198, 0.744097194472103, 0.7111858534048582],
            [-0.21163171332200198, -0.744097194472103, 0.7111858534048582],
            [0.0, 0.9951515529590366, -0.5745510169853739],
            [0.0, -0.9951515529590366, -0.5745510169853739],
            [0.21163171332200198, -0.9879536130967743, 0.2888141465951419],
            [-0.21163171332200198, 0.9879536130967743, 0.2888141465951419],
            [2.029963793177167, 0.0, 0.0],
            [-2.029963793177167, 0.0, 0.0]
        ]
    },
    "D2h": {
        "vertices": [
            [0.0, 0.5, 1.0],
            [0.0, 0.5, -1.0],
            [0.0, -0.5, 1.0],
            [0.0, -0.5, -1.0],
            [1.0, 1.0, 0.0],
            [1.0, -1.0, 0.0],
            [-1.0, 1.0, 0.0],
            [-1.0, -1.0, 0.0]
        ]
    },
    "D3h": {
        "vertices": [
            [0.0, 0.0, 1.1547005383792515],
            [0.0, 0.0, -1.1547005383792515],
            [1.7320508075688772, 1.0, 0.0],
            [-1.7320508075688772, 1.0, 0.0],
            [0.0, -2.0, 0.0]
        ]
    },
    "D4h": {
        "vertices": [
            [0.0, 0.0, 1.0606601717798212],
            [0.0, 0.0, -1.0606601717798212],
            [0.7071067811865476, 0.7071067811865476, 0.7071067811865476],
            [0.7071067811865476, 0.7071067811865476, -0.7071067811865476],
            [0.7071067811865476, -0.7071067811865476, 0.7071067811865476],
            [0.7071067811865476, -0.7071067811865476, -0.7071067811865476],
            [-0.7071067811865476, 0.7071067811865476, 0.7071067811865476],
            [-0.7071067811865476, 0.7071067811865476, -0.7071067811865476],
            [-0.7071067811865476, -0.7071067811865476, 0.7071067811865476],
            [-0.7071067811865476, -0.7071067811865476, -0.7071067811865476]
        ]
    },
    "D5h": {
        "vertices": [
            [0.0, 0.0, 1.7013016167040798],
            [0.0, 0.0, -1.7013016167040798],
            [1.1755705045849463, -0.38196601125010515, 0.0],
            [-1.1755705045849463, -0.38196601125010515, 0.0],
            [0.7265425280053609, 1.0, 0.0],
            [-0.7265425280053609, 1.0, 0.0],
            [0.0, -1.2360679774997898, 0.0]
        ]
    },
    "D6h": {
        "vertices": [
            [0.0, 0.0, 2.0],
            [0.0, 0.0, -2.0],
            [1.0, 0.5773502691896257, 0.0],
            [1.0, -0.5773502691896257, 0.0],
            [-1.0, 0.5773502691896257, 0.0],
            [-1.0, -0.5773502691896257, 0.0],
            [0.0, 1.1547005383792515, 0.0],
            [0.0, -1.1547005383792515, 0.0]
        ]
    },
    "D7h": {
        "vertices": [
            [0.0, 0.0, 2.3047648709624866],
            [0.0, 0.0, -2.3047648709624866],
            [1.0820883461285309, 0.24697960371746705, 0.0],
            [-1.0820883461285309, 0.24697960371746705, 0.0],
            [0.8677674782351162, -0.6920214716300959, 0.0],
            [-0.8677674782351162, -0.6920214716300959, 0.0],
            [0.48157461880752866, 1.0, 0.0],
            [-0.48157461880752866, 1.0, 0.0],
            [0.0, -1.1099162641747424, 0.0]
        ]
    },
    "D8h": {
        "vertices": [
            [0.0, 0.0, 2.613125929752753],
            [0.0, 0.0, -2.613125929752753],
            [1.082392200292394, 0.0, 0.0],
            [-1.082392200292394, 0.0, 0.0],
            [0.0, 1.082392200292394, 0.0],
            [0.0, -1.082392200292394, 0.0],
            [0.7653668647301796, 0.7653668647301796, 0.0],
            [0.7653668647301796, -0.7653668647301796, 0.0],
            [-0.7653668647301796, 0.7653668647301796, 0.0],
            [-0.7653668647301796, -0.7653668647301796, 0.0]
        ]
    },
    "D9h": {
        "vertices": [
            [0.0, 0.0, -2.923804400163087],
            [0.0, 0.0, 2.923804400163087],
            [1.0480105209175399, -0.18479253090409536, 0.0],
            [-1.0480105209175399, -0.18479253090409536, 0.0],
            [0.9216049851068763, 0.532088886237956, 0.0],
            [-0.9216049851068763, 0.532088886237956, 0.0],
            [0.6840402866513374, -0.8152074690959046, 0.0],
            [-0.6840402866513374, -0.8152074690959046, 0.0],
            [0.36397023426620234, 1.0, 0.0],
            [-0.36397023426620234, 1.0, 0.0],
            [0.0, -1.064177772475912, 0.0]
        ]
    },
    "D10h": {
        "vertices": [
            [0.0, 0.0, 3.23606797749979],
            [0.0, 0.0, -3.23606797749979],
            [0.0, 1.0514622242382672, 0.0],
            [0.0, -1.0514622242382672, 0.0],
            [1.0, 0.32491969623290634, 0.0],
            [1.0, -0.32491969623290634, 0.0],
            [-1.0, 0.32491969623290634, 0.0],
            [-1.0, -0.32491969623290634, 0.0],
            [0.6180339887498949, 0.8506508083520399, 0.0],
            [0.6180339887498949, -0.8506508083520399, 0.0],
            [-0.6180339887498949, 0.8506508083520399, 0.0],
            [-0.6180339887498949, -0.8506508083520399, 0.0]
        ]
    },
    "D2v": {
        "vertices": [
            [1.0, 0.0, 1.0],
            [-1.0, 0.0, 1.0],
            [0.0, 1.0, -1.0],
            [0.0, -1.0, -1.0],
            [1.0, 0.0, -0.5],
            [-1.0, 0.0, -0.5],
            [0.0, 1.0, 0.5],
            [0.0, -1.0, 0.5]
        ]
    },
    "D3v": {
        "vertices": [
            [0.0, 0.0, 1.4142135623730951],
            [0.0, 0.0, -1.4142135623730951],
            [1.4142135623730951, 0.0, 0.0],
            [-1.4142135623730951, 0.0, 0.0],
            [0.0, 1.4142135623730951, 0.0],
            [0.0, -1.4142135623730951, 0.0],
            [0.585786437626905, 0.585786437626905, 0.585786437626905],
            [-0.585786437626905, -0.585786437626905, -0.585786437626905]
        ]
    },
    "D4v": {
        "vertices": [
            [0.7653668647301796, 0.7653668647301796, 0.6435942529055826],
            [0.7653668647301796, -0.7653668647301796, 0.6435942529055826],
            [-0.7653668647301796, 0.7653668647301796, 0.6435942529055826],
            [-0.7653668647301796, -0.7653668647301796, 0.6435942529055826],
            [1.082392200292394, 0.0, -0.6435942529055826],
            [-1.082392200292394, 0.0, -0.6435942529055826],
            [0.0, 1.082392200292394, -0.6435942529055826],
            [0.0, -1.082392200292394, -0.6435942529055826]
        ]
    },
    "D5v": {
        "vertices": [
            [0.6180339887498949, 0.0, 1.0],
            [0.6180339887498949, 0.0, -1.0],
            [-0.6180339887498949, 0.0, 1.0],
            [-0.6180339887498949, 0.0, -1.0],
            [0.0, 1.0, 0.6180339887498949],
            [0.0, 1.0, -0.6180339887498949],
            [0.0, -1.0, 0.6180339887498949],
            [0.0, -1.0, -0.6180339887498949],
            [1.0, 0.6180339887498949, 0.0],
            [-1.0, -0.6180339887498949, 0.0]
        ]
    },
    "D6v": {
        "vertices": [
            [1.035276180410083, 0.0, 0.4428909828689583],
            [-1.035276180410083, 0.0, 0.4428909828689583],
            [0.5176380902050415, 0.8965754721680536, 0.4428909828689583],
            [0.5176380902050415, -0.8965754721680536, 0.4428909828689583],
            [-0.5176380902050415, 0.8965754721680536, 0.4428909828689583],
            [-0.5176380902050415, -0.8965754721680536, 0.4428909828689583],
            [0.8965754721680536, 0.5176380902050415, -0.4428909828689583],
            [0.8965754721680536, -0.5176380902050415, -0.4428909828689583],
            [-0.8965754721680536, 0.5176380902050415, -0.4428909828689583],
            [-0.8965754721680536, -0.5176380902050415, -0.4428909828689583],
            [0.0, 1.035276180410083, -0.4428909828689583],
            [0.0, -1.035276180410083, -0.4428909828689583]
        ]
    },
    "T": {
        "vertices": [
            [0.5097553324933856, 0.13968058199610653, 1.0],
            [0.5097553324933856, -0.13968058199610653, -1.0],
            [-0.5097553324933856, -0.13968058199610653, 1.0],
            [-0.5097553324933856, 0.13968058199610653, -1.0],
            [1.0, 0.5097553324933856, 0.13968058199610653],
            [1.0, -0.5097553324933856, -0.13968058199610653],
            [-1.0, -0.5097553324933856, 0.13968058199610653],
            [-1.0, 0.5097553324933856, -0.13968058199610653],
            [0.13968058199610653, 1.0, 0.5097553324933856],
            [0.13968058199610653, -1.0, -0.5097553324933856],
            [-0.13968058199610653, -1.0, 0.5097553324933856],
            [-0.13968058199610653, 1.0, -0.5097553324933856],
            [0.6062678708614785, -0.6062678708614785, 0.6062678708614785],
            [0.6062678708614785, 0.6062678708614785, -0.6062678708614785],
            [-0.6062678708614785, 0.6062678708614785, 0.6062678708614785],
            [-0.6062678708614785, -0.6062678708614785, -0.6062678708614785]
        ]
    },
    "Td": {
        "vertices": [
            [1.0, -1.0, 1.0],
            [1.0, 1.0, -1.0],
            [-1.0, 1.0, 1.0],
            [-1.0, -1.0, -1.0]
        ]
    },
    "Th": {
        "vertices": [
            [0.41421356237309503, 0.0, 1.0],
            [0.41421356237309503, 0.0, -1.0],
            [-0.41421356237309503, 0.0, 1.0],
            [-0.41421356237309503, 0.0, -1.0],
            [1.0, 0.41421356237309503, 0.0],
            [1.0, -0.41421356237309503, 0.0],
            [-1.0, 0.41421356237309503, 0.0],
            [-1.0, -0.41421356237309503, 0.0],
            [0.0, 1.0, 0.41421356237309503],
            [0.0, 1.0, -0.41421356237309503],
            [0.0, -1.0, 0.41421356237309503],
            [0.0, -1.0, -0.41421356237309503],
            [0.0, 0.5224077499274828, 0.8918058124456122],
            [0.0, 0.5224077499274828, -0.8918058124456122],
            [0.0, -0.5224077499274828, 0.8918058124456122],
            [0.0, -0.5224077499274828, -0.8918058124456122],
            [0.8918058124456122, 0.0, 0.5224077499274828],
            [0.8918058124456122, 0.0, -0.5224077499274828],
            [-0.8918058124456122, 0.0, 0.5224077499274828],
            [-0.8918058124456122, 0.0, -0.5224077499274828],
            [0.5224077499274828, 0.8918058124456122, 0.0],
            [0.5224077499274828, -0.8918058124456122, 0.0],
            [-0.5224077499274828, 0.8918058124456122, 0.0],
            [-0.5224077499274828, -0.8918058124456122, 0.0]
        ]
    },
    "O": {
        "vertices": [
            [0.4980876129457463, 0.2708047625166259, 0.9161259494273487],
            [0.4980876129457463, -0.2708047625166259, -0.9161259494273487],
            [-0.4980876129457463, -0.2708047625166259, 0.9161259494273487],
            [-0.4980876129457463, 0.2708047625166259, -0.9161259494273487],
            [0.9161259494273487, 0.4980876129457463, 0.2708047625166259],
            [0.9161259494273487, -0.4980876129457463, -0.2708047625166259],
            [-0.9161259494273487, -0.4980876129457463, 0.2708047625166259],
            [-0.9161259494273487, 0.4980876129457463, -0.2708047625166259],
            [0.2708047625166259, 0.9161259494273487, 0.4980876129457463],
            [0.2708047625166259, -0.9161259494273487, -0.4980876129457463],
            [-0.2708047625166259, -0.9161259494273487, 0.4980876129457463],
            [-0.2708047625166259, 0.9161259494273487, -0.4980876129457463],
            [0.2708047625166259, -0.4980876129457463, 0.9161259494273487],
            [0.2708047625166259, 0.4980876129457463, -0.9161259494273487],
            [-0.2708047625166259, 0.4980876129457463, 0.9161259494273487],
            [-0.2708047625166259, -0.4980876129457463, -0.9161259494273487],
            [0.9161259494273487, -0.2708047625166259, 0.4980876129457463],
            [0.9161259494273487, 0.2708047625166259, -0.4980876129457463],
            [-0.9161259494273487, 0.2708047625166259, 0.4980876129457463],
            [-0.9161259494273487, -0.2708047625166259, -0.4980876129457463],
            [0.4980876129457463, -0.9161259494273487, 0.2708047625166259],
            [0.4980876129457463, 0.9161259494273487, -0.2708047625166259],
            [-0.4980876129457463, 0.9161259494273487, 0.2708047625166259],
            [-0.4980876129457463, -0.9161259494273487, -0.2708047625166259]
        ]
    },
    "Oh": {
        "vertices": [
            [0.0, 0.0, 1.4142135623730951],
            [0.0, 0.0, -1.4142135623730951],
            [1.4142135623730951, 0.0, 0.0],
            [-1.4142135623730951, 0.0, 0.0],
            [0.0, 1.4142135623730951, 0.0],
            [0.0, -1.4142135623730951, 0.0]
        ]
    },
    "I": {
        "vertices": [
            [0.17873726072917187, -0.15780282755118874, 1.0],
            [0.17873726072917187, 0.15780282755118874, -1.0],
            [-0.17873726072917187, 0.15780282755118874, 1.0],
            [-0.17873726072917187, -0.15780282755118874, -1.0],
            [1.0, -0.17873726072917187, 0.15780282755118874],
            [1.0, 0.17873726072917187, -0.15780282755118874],
            [-1.0, 0.17873726072917187, 0.15780282755118874],
            [-1.0, -0.17873726072917187, -0.15780282755118874],
            [0.15780282755118874, -1.0, 0.17873726072917187],
            [0.15780282755118874, 1.0, -0.17873726072917187],
            [-0.15780282755118874, 1.0, 0.17873726072917187],
            [-0.15780282755118874, -1.0, -0.17873726072917187],
            [0.2707204554902025, 0.30663476306833753, 0.9431512592438818],
            [0.2707204554902025, -0.30663476306833753, -0.9431512592438818],
            [-0.2707204554902025, -0.30663476306833753, 0.9431512592438818],
            [-0.2707204554902025, 0.30663476306833753, -0.9431512592438818],
            [0.9431512592438818, 0.2707204554902025, 0.30663476306833753],
            [0.9431512592438818, -0.2707204554902025, -0.30663476306833753],
            [-0.9431512592438818, -0.2707204554902025, 0.30663476306833753],
            [-0.9431512592438818, 0.2707204554902025, -0.30663476306833753],
            [0.30663476306833753, 0.9431512592438818, 0.2707204554902025],
            [0.30663476306833753, -0.9431512592438818, -0.2707204554902025],
            [-0.30663476306833753, -0.9431512592438818, 0.2707204554902025],
            [-0.30663476306833753, 0.9431512592438818, -0.2707204554902025],
            [0.09198319476103062, -0.5958377259841895, 0.8326855570572018],
            [0.09198319476103062, 0.5958377259841895, -0.8326855570572018],
            [-0.09198319476103062, 0.5958377259841895, 0.8326855570572018],
            [-0.09198319476103062, -0.5958377259841895, -0.8326855570572018],
            [0.8326855570572018, -0.09198319476103062, 0.5958377259841895],
            [0.8326855570572018, 0.09198319476103062, -0.5958377259841895],
            [-0.8326855570572018, 0.09198319476103062, 0.5958377259841895],
            [-0.8326855570572018, -0.09198319476103062, -0.5958377259841895],
            [0.5958377259841895, -0.8326855570572018, 0.09198319476103062],
            [0.5958377259841895, 0.8326855570572018, -0.09198319476103062],
            [-0.5958377259841895, 0.8326855570572018, 0.09198319476103062],
            [-0.5958377259841895, -0.8326855570572018, -0.09198319476103062],
            [0.5260507939888642, -0.40416227401581056, 0.7853484316926931],
            [0.5260507939888642, 0.40416227401581056, -0.7853484316926931],
            [-0.5260507939888642, 0.40416227401581056, 0.7853484316926931],
            [-0.5260507939888642, -0.40416227401581056, -0.7853484316926931],
            [0.7853484316926931, -0.5260507939888642, 0.40416227401581056],
            [0.7853484316926931, 0.5260507939888642, -0.40416227401581056],
            [-0.7853484316926931, 0.5260507939888642, 0.40416227401581056],
            [-0.7853484316926931, -0.5260507939888642, -0.40416227401581056],
            [0.40416227401581056, -0.7853484316926931, 0.5260507939888642],
            [0.40416227401581056, 0.7853484316926931, -0.5260507939888642],
            [-0.40416227401581056, 0.7853484316926931, 0.5260507939888642],
            [-0.40416227401581056, -0.7853484316926931, -0.5260507939888642],
            [0.674882729506013, 0.34731353325969233, 0.6933652369316624],
            [0.674882729506013, -0.34731353325969233, -0.6933652369316624],
            [-0.674882729506013, -0.34731353325969233, 0.6933652369316624],
            [-0.674882729506013, 0.34731353325969233, -0.6933652369316624],
            [0.6933652369316624, 0.674882729506013, 0.34731353325969233],
            [0.6933652369316624, -0.674882729506013, -0.34731353325969233],
            [-0.6933652369316624, -0.674882729506013, 0.34731353325969233],
            [-0.6933652369316624, 0.674882729506013, -0.34731353325969233],
            [0.34731353325969233, 0.6933652369316624, 0.674882729506013],
            [0.34731353325969233, -0.6933652369316624, -0.674882729506013],
            [-0.34731353325969233, -0.6933652369316624, 0.674882729506013],
            [-0.34731353325969233, 0.6933652369316624, -0.674882729506013]
        ]
    },
    "Ih": {
        "vertices": [
            [0.6180339887498949, 0.0, 1.0],
            [0.6180339887498949, 0.0, -1.0],
            [-0.6180339887498949, 0.0, 1.0],
            [-0.6180339887498949, 0.0, -1.0],
            [1.0, 0.6180339887498949, 0.0],
            [1.0, -0.6180339887498949, 0.0],
            [-1.0, 0.6180339887498949, 0.0],
            [-1.0, -0.6180339887498949, 0.0],
            [0.0, 1.0, 0.6180339887498949],
            [0.0, 1.0, -0.6180339887498949],
            [0.0, -1.0, 0.6180339887498949],
            [0.0, -1.0, -0.6180339887498949]
        ]
    }
}


# For testing shapes in dictionary
@pytest.mark.parametrize(
    "shape_name, vertices",
    (
        (shape_name, vertices)
        for shape_name, shape_info in shapes_data.items()
        for vertices in [shape_info['vertices']]
    ),
)
def test_dict_shapes_symmetry(shape_name, vertices):  
    symmetry=shape_name
    conftest.check_symmetry(
        symmetry=symmetry, vertices=np.array(vertices), threshold=cutoff
    )


# Function to see that shapes in dict formed correctly - saving for future shapes
def select_shape(shape_name):
    if shape_name not in shapes_data:
        raise ValueError(f"Shape '{shape_name}' not found.")
    shape_info = shapes_data[shape_name]
    vertices = shape_info["vertices"]
    polyhedra=coxeter.shapes.ConvexPolyhedron(vertices)
    polyhedra.plot()
    return polyhedra