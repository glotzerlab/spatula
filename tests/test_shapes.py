import coxeter
import freud
import numpy as np
import pytest

import pgop

cutoff = 0.99

n_dict = {
    3: "Triangular",
    4: "Square",
    5: "Pentagonal",
    6: "Hexagonal",
    7: "Heptagonal",
    8: "Octagonal",
    9: "Nonagonal",
    10: "Decagonal",
}


pgop_dict = dict()


pgop.util.set_num_threads(1)


def get_shape_sys_nlist(vertices):
    """Get a neighbor list of a shape.

    The neighbor list has a single point with all vertices as neighbors.
    """
    # shape = coxeter.shapes.ConvexPolyhedron(vertices)
    # shape.centroid = (0.0, 0.0, 0.0)
    # vertices = shape.vertices
    query_point_indices = np.zeros(len(vertices), dtype=int)
    point_indices = np.arange(0, len(vertices), dtype=int)
    # compute bond vectors between from query points to points
    vectors = vertices[point_indices] - vertices[query_point_indices]
    distances = np.linalg.norm(vertices, axis=1)
    return (
        (freud.Box.cube(2.1 * np.max(distances)), vertices),
        freud.locality.NeighborList.from_arrays(
            1, len(vertices), query_point_indices, point_indices, vectors
        ),
    )


def check_symmetry(symmetry, vertices):
    """Determine whether given shape have a specified symmetry.

    Parameters
    ----------
    symmetry: str
        The symmetry to test for.
    vertices: :math:`(N, 3)` numpy.ndarray of floats
        The vertices of the shape
    threshold: float
        The threshold below which ``check_symmetry`` returns ``False`` for
        ``has_symmetry == True`` and above which ``check_symmetry`` returns
        ``False`` for ``has_symmetry == False``.
    has_symmetry: bool, optional
        Whether to test if the shape has or does not have the symmetry.
    """
    vertices = np.asarray(vertices)
    # n_axes must be at least 50 for Dnh to work correctly. Further increases bring Dnd
    # close to one as well.
    optimizer = pgop.optimize.Union.with_step_gradient_descent(
        pgop.optimize.Mesh.from_grid(n_axes=65)
    )
    # check if PGOP is already in the dictionary
    if symmetry not in pgop_dict:
        pgop_dict[symmetry] = pgop.PGOP(
            "fisher", [symmetry], optimizer, max_l=9, kappa=20.0
        )
    op_compute = pgop_dict[symmetry]

    system, nlist = get_shape_sys_nlist(vertices)
    # these options are lowest possible that tests pass.
    op_compute.compute(system, nlist, query_points=np.zeros((1, 3)), m=9)
    return op_compute.pgop[0]


def get_pyramid(n: int) -> np.ndarray:
    base = coxeter.families.RegularNGonFamily().get_shape(n).vertices
    # Need to offset polygon to make dihedral order low for testing.
    return (
        f"Pyramid({n})",
        np.concatenate((base - np.array([0.0, 0.0, -0.5]), [[0.0, 0.0, 3.0]])),
    )


def get_bipyramid(n: int) -> np.ndarray:
    base = coxeter.families.RegularNGonFamily().get_shape(n).vertices
    return (
        f"Bipyramid({n})",
        np.concatenate((base, [[0.0, 0.0, 3.0], [0.0, 0.0, -3.0]])),
    )


def parse_shape_values(
    a: str | tuple[str, np.ndarray],
) -> tuple[str, np.ndarray]:
    if isinstance(a, tuple):
        return a
    family, shape = a.split(".")
    if shape.isdigit():
        shape = int(shape)

    vertices = getattr(coxeter.families, family).get_shape(shape).vertices
    return shape, vertices


def _id_func(value):
    if isinstance(value, str):
        return value
    elif isinstance(value, int):
        return f"NGon{value}"
    return ""


# TODO later:
# T : Propello Tetrahedron
# O : Propello Cube, Propello Octahedron
# I : Propello Dodecahedron, Propello Icosahedron
# Dnd : Trapezohedron
###################################################
# TODO: add other options for shapes of interest
# The vertices found in this dictionary for all these shapes were taken from http://dmccooey.com/polyhedra/Simplest.html
shape_symmetries = {
    "C1": [
        (
            "vertices",
            [
                [
                    1.56922900989136486079919529624,
                    0.127344173132779220661025515340,
                    -0.594246684979361531856095101193,
                ],
                [
                    0.0544154317961383030163066010436,
                    -0.947594490792603122917402692721,
                    -0.594246684979361531856095101193,
                ],
                [
                    -1.67017858435830105053903440232,
                    0.0,
                    -0.594246684979361531856095101193,
                ],
                [
                    -0.0213946139374397854092095434663,
                    0.905939944266888642915620773436,
                    -0.594246684979361531856095101193,
                ],
                [
                    0.408714532008138679156653441174,
                    -0.984198346940939589795611220376,
                    0.362199783826854559024170380756,
                ],
                [
                    -0.0120908032100600645529433979780,
                    1.16488491635665498242827880542,
                    0.788799869882532888666060905952,
                ],
                [
                    -0.384754129324100147766981384357,
                    -0.433371335880031688698557665178,
                    1.05712424949451132235936641797,
                ],
            ],
        ),
        (
            "vertices-2",
            [
                [0.8007618912594414, 0.7516350841971927, -0.4027433829029944],
                [1.1029498630572625, -1.0276004804487782, -0.4027433829029944],
                [-0.6049588541429178, -0.8604924250430251, -0.4027433829029944],
                [-1.013015119275374, 0.0, -0.4027433829029944],
                [-0.5100481304476243, 1.0606362918909986, -0.4027433829029944],
                [0.9244995677026183, 0.28349630094569334, 0.4582538419333087],
                [-0.9253484067369404, -0.2163279003583168, 2.293921494718945],
            ],
        ),
    ],
    "Ci": [
        (
            "vertices",
            [
                [1.189207115002721, 0.0, 1.0],
                [-1.189207115002721, 0.0, -1.0],
                [-0.49258571550470803, 0.0, 1.0],
                [0.49258571550470803, 0.0, -1.0],
                [-0.8408964152537145, 0.49258571550470803, 0.41421356237309503],
                [0.8408964152537145, -0.49258571550470803, -0.41421356237309503],
                [-0.3483106997490065, -1.189207115002721, 0.41421356237309503],
                [0.3483106997490065, 1.189207115002721, -0.41421356237309503],
                [0.5946035575013605, -0.8408964152537145, 0.0],
                [-0.5946035575013605, 0.8408964152537145, 0.0],
            ],
        )
    ],
    "Cs": [
        (
            "vertices",
            [
                [1.3737233664112654, -0.553529398617591, 0.8328296373605156],
                [-1.3737233664112654, -0.553529398617591, 0.8328296373605156],
                [0.5049089371450616, -0.553529398617591, -0.8328296373605156],
                [-0.5049089371450616, -0.553529398617591, -0.8328296373605156],
                [0.0, 0.5401563613890422, 0.9252962109065457],
                [0.0, 2.2892449735263116, -1.258960428697956],
            ],
        ),
        (
            "vertices-2",
            [
                [1.1308602751428245, 0.46267782041032823, -0.382762006411681],
                [-1.1308602751428245, 0.46267782041032823, -0.382762006411681],
                [0.6635261621303494, -0.9238469821608469, -0.382762006411681],
                [-0.6635261621303494, -0.9238469821608469, -0.382762006411681],
                [0.0, 1.0356697454981418, -0.382762006411681],
                [0.0, 0.8705630105371348, 1.5829981233573815],
                [0.0, -0.9498272409359462, 0.6320446478446134],
            ],
        ),
    ],
    "C2": [
        (
            "vertices",
            [
                [0.47895290007454705, 0.6092375000865723, 1.0],
                [-0.47895290007454705, -0.6092375000865723, 1.0],
                [1.5950044824476632, 0.0, -1.0],
                [-1.5950044824476632, 0.0, -1.0],
                [0.0, 1.13589310962197, -0.11972592295680519],
                [0.0, -1.13589310962197, -0.11972592295680519],
            ],
        )
    ],
    "C3": [
        (
            "vertices",
            [
                [0.09721493414474791, 0.8917128617235874, 0.8937837306664239],
                [-0.8208534582063212, -0.3616658282652108, 0.8937837306664239],
                [0.7236385240615733, -0.5300470334583767, 0.8937837306664239],
                [1.222667862618902, 0.0, -0.7913727468328255],
                [-0.611333931309451, 1.058861429418791, -0.7913727468328255],
                [-0.611333931309451, -1.058861429418791, -0.7913727468328255],
                [-1.0367052338386331, 0.0, -0.08116122495760766],
                [0.5183526169193166, -0.8978130687405432, -0.08116122495760766],
                [0.5183526169193166, 0.8978130687405432, -0.08116122495760766],
            ],
        ),
        (
            "vertices-2",
            [
                [0.0, 0.0, 1.1188388932235083],
                [0.0, 0.0, -1.2636270379566736],
                [0.0, 1.2436893138327536, 0.4947590294656065],
                [-1.0770665401944017, -0.6218446569163768, 0.4947590294656065],
                [1.0770665401944017, -0.6218446569163768, 0.4947590294656065],
                [0.9159637141900596, 0.09985877290347703, -0.5518542863737882],
                [-0.5444620912201821, 0.7433184589816021, -0.5518542863737882],
                [-0.37150162296987754, -0.8431772318850791, -0.5518542863737882],
                [0.0, -1.0588750792704977, 0.05615771094129951],
                [0.9170127180825124, 0.5294375396352489, 0.05615771094129951],
                [-0.9170127180825124, 0.5294375396352489, 0.05615771094129951],
            ],
        ),
        (
            "vertices-3",
            [
                [0.0, 0.0, 2.854983680047803],
                [0.6875820522678492, -0.7428909472284139, 0.14809515992007738],
                [0.29957140640736657, 0.966908998064404, 0.14809515992007738],
                [-0.9871534586752158, -0.2240180508359902, 0.14809515992007738],
                [0.0, -1.198616828322378, -0.3502646992305246],
                [0.0, 1.005960314056215, -0.3502646992305246],
                [0.8711871871716543, -0.5029801570281075, -0.3502646992305246],
                [-0.8711871871716543, -0.5029801570281075, -0.3502646992305246],
                [1.0380326227307104, 0.599308414161189, -0.3502646992305246],
                [-1.0380326227307104, 0.599308414161189, -0.3502646992305246],
            ],
        ),
        (
            "vertices-4",
            [
                [0.0, 0.0, 1.3141376019295983],
                [-0.6046286567813116, 0.728667176602242, 0.5068331105134641],
                [-0.32872995745076766, -0.8879573649297992, 0.5068331105134641],
                [0.9333586142320793, 0.1592901883275572, 0.5068331105134641],
                [0.0, 1.2976085700537934, -0.7609553204562916],
                [-1.1237619858349845, -0.6488042850268967, -0.7609553204562916],
                [1.1237619858349845, -0.6488042850268967, -0.7609553204562916],
                [0.0, -1.0335497828354645, -0.04218293305535333],
                [0.8950803680114021, 0.5167748914177323, -0.04218293305535333],
                [-0.8950803680114021, 0.5167748914177323, -0.04218293305535333],
            ],
        ),
    ],
    "C4": [
        (
            "vertices",
            [
                [0.9020768831634525, 0.28480944998815594, 0.7433508169295151],
                [-0.9020768831634525, -0.28480944998815594, 0.7433508169295151],
                [0.28480944998815594, -0.9020768831634525, 0.7433508169295151],
                [-0.28480944998815594, 0.9020768831634525, 0.7433508169295151],
                [0.7863247436800825, 0.7863247436800825, -0.6178134002079047],
                [0.7863247436800825, -0.7863247436800825, -0.6178134002079047],
                [-0.7863247436800825, 0.7863247436800825, -0.6178134002079047],
                [-0.7863247436800825, -0.7863247436800825, -0.6178134002079047],
                [1.017425061294311, 0.0, -0.0692776715108155],
                [-1.017425061294311, 0.0, -0.0692776715108155],
                [0.0, 1.017425061294311, -0.0692776715108155],
                [0.0, -1.017425061294311, -0.0692776715108155],
            ],
        ),
        (
            "vertices-2",
            [
                [0.0, 0.0, 1.3452598385922276],
                [0.0, 0.0, -1.6186117032480731],
                [1.1328590547091837, 0.0, 0.3258603882288007],
                [-1.1328590547091837, 0.0, 0.3258603882288007],
                [0.0, 1.1328590547091837, 0.3258603882288007],
                [0.0, -1.1328590547091837, 0.3258603882288007],
                [0.8476783194348434, 0.4408545332277052, -0.40254079691970585],
                [-0.8476783194348434, -0.4408545332277052, -0.40254079691970585],
                [0.4408545332277052, -0.8476783194348434, -0.40254079691970585],
                [-0.4408545332277052, 0.8476783194348434, -0.40254079691970585],
                [0.730369462550913, 0.730369462550913, 0.030818778000162004],
                [0.730369462550913, -0.730369462550913, 0.030818778000162004],
                [-0.730369462550913, 0.730369462550913, 0.030818778000162004],
                [-0.730369462550913, -0.730369462550913, 0.030818778000162004],
            ],
        ),
        (
            "vertices-3",
            [
                [0.0, 0.0, 1.768056452099878],
                [0.8361792910629785, -0.5027376019057023, 0.3454360378972734],
                [-0.8361792910629785, 0.5027376019057023, 0.3454360378972734],
                [0.5027376019057023, 0.8361792910629785, 0.3454360378972734],
                [-0.5027376019057023, -0.8361792910629785, 0.3454360378972734],
                [1.166280227167637, 0.0, -0.565592800395216],
                [-1.166280227167637, 0.0, -0.565592800395216],
                [0.0, 1.166280227167637, -0.565592800395216],
                [0.0, -1.166280227167637, -0.565592800395216],
                [0.7180781683088163, 0.7180781683088163, -0.026595247818667966],
                [0.7180781683088163, -0.7180781683088163, -0.026595247818667966],
                [-0.7180781683088163, 0.7180781683088163, -0.026595247818667966],
                [-0.7180781683088163, -0.7180781683088163, -0.026595247818667966],
            ],
        ),
        (
            "vertices-4",
            [
                [0.0, 0.0, 3.860101644780593],
                [0.8543794982772945, -0.5319049001893495, 0.10783285780066124],
                [-0.8543794982772945, 0.5319049001893495, 0.10783285780066124],
                [0.5319049001893495, 0.8543794982772945, 0.10783285780066124],
                [-0.5319049001893495, -0.8543794982772945, 0.10783285780066124],
                [1.104830058729472, 0.0, -0.25906053571209514],
                [-1.104830058729472, 0.0, -0.25906053571209514],
                [0.0, 1.104830058729472, -0.25906053571209514],
                [0.0, -1.104830058729472, -0.25906053571209514],
                [0.7103212389528519, 0.7103212389528519, -0.25906053571209514],
                [0.7103212389528519, -0.7103212389528519, -0.25906053571209514],
                [-0.7103212389528519, 0.7103212389528519, -0.25906053571209514],
                [-0.7103212389528519, -0.7103212389528519, -0.25906053571209514],
            ],
        ),
        (
            "vertices-5",
            [
                [0.0, 0.0, 1.3052678471142751],
                [1.102522580563977, 0.0, 0.38038074871751476],
                [-1.102522580563977, 0.0, 0.38038074871751476],
                [0.0, 1.102522580563977, 0.38038074871751476],
                [0.0, -1.102522580563977, 0.38038074871751476],
                [0.8214563336258981, -0.38898655297908613, -0.7661262799132222],
                [-0.8214563336258981, 0.38898655297908613, -0.7661262799132222],
                [0.38898655297908613, 0.8214563336258981, -0.7661262799132222],
                [-0.38898655297908613, -0.8214563336258981, -0.7661262799132222],
                [0.7309327245573741, 0.7309327245573741, 0.0789342397004545],
                [0.7309327245573741, -0.7309327245573741, 0.0789342397004545],
                [-0.7309327245573741, 0.7309327245573741, 0.0789342397004545],
                [-0.7309327245573741, -0.7309327245573741, 0.0789342397004545],
            ],
        ),
    ],
    "C2h": [
        (
            "vertices",
            [
                [0.0, 0.0, 1.618033988749895],
                [0.0, 0.0, -1.618033988749895],
                [0.0, 0.9717365435132913, 0.38196601125010515],
                [0.0, -0.9717365435132913, -0.38196601125010515],
                [1.0, 0.7861513777574233, 0.0],
                [1.0, -0.7861513777574233, 0.0],
                [-1.0, 0.7861513777574233, 0.0],
                [-1.0, -0.7861513777574233, 0.0],
            ],
        ),
        (
            "vertices-2",
            [
                [-0.4370160244488211, 0.0, 0.977197537924274],
                [0.4370160244488211, 0.0, -0.977197537924274],
                [0.4370160244488211, -0.48586827175664565, 0.977197537924274],
                [-0.4370160244488211, 0.48586827175664565, -0.977197537924274],
                [-0.977197537924274, 0.0, 0.4370160244488211],
                [0.977197537924274, 0.0, -0.4370160244488211],
                [0.977197537924274, 0.48586827175664565, 0.4370160244488211],
                [-0.977197537924274, -0.48586827175664565, -0.4370160244488211],
                [-0.4370160244488211, 1.272019649514069, 0.4370160244488211],
                [0.4370160244488211, -1.272019649514069, -0.4370160244488211],
            ],
        ),
    ],
    "C2v": [
        (
            "vertices",
            [
                [0.0, 0.0, 1.8116245508069786],
                [0.930617210618515, 0.0, -1.0],
                [-0.930617210618515, 0.0, -1.0],
                [0.575859742086094, 0.9974183313266246, 0.07180997377531669],
                [0.575859742086094, -0.9974183313266246, 0.07180997377531669],
                [-0.575859742086094, 0.9974183313266246, 0.07180997377531669],
                [-0.575859742086094, -0.9974183313266246, 0.07180997377531669],
            ],
        ),
        (
            "vertices-2",
            [
                [0.0, 1.0745841941261967, 1.0],
                [0.0, -1.0745841941261967, 1.0],
                [1.6677004630016656, 0.0, -0.5519907530258161],
                [-1.6677004630016656, 0.0, -0.5519907530258161],
                [0.0, 0.9628473112416752, -0.5519907530258161],
                [0.0, -0.9628473112416752, -0.5519907530258161],
            ],
        ),
    ],
    "C3v": [
        (
            "vertices",
            [
                [1.0, -1.0, 1.0],
                [-1.0, 1.0, 1.0],
                [1.0, 1.0, -1.0],
                [-1.0, -0.3333333333333333, -0.3333333333333333],
                [-0.3333333333333333, -1.0, -0.3333333333333333],
                [-0.3333333333333333, -0.3333333333333333, -1.0],
                [0.6, 0.6, 0.6],
            ],
        ),
        (
            "vertices-2",
            [
                [0.7745966692414834, -0.7745966692414834, 1.0],
                [-0.7745966692414834, 0.7745966692414834, 1.0],
                [0.7745966692414834, -0.5485724072577316, -0.6583592135001262],
                [-0.5485724072577316, 0.7745966692414834, -0.6583592135001262],
                [-0.7745966692414834, -0.7745966692414834, 0.3665631459994953],
                [1.0392304845413263, 1.0392304845413263, -0.2],
                [-0.5773502691896257, -0.5773502691896257, -1.0],
            ],
        ),
    ],
    "S4": [
        (
            "vertices",
            [
                [0.0, 0.0, 1.176614197732676],
                [0.0, 0.0, -1.176614197732676],
                [0.36031346070627496, 0.6612064329575712, 0.7097370431606547],
                [-0.36031346070627496, -0.6612064329575712, 0.7097370431606547],
                [0.6612064329575712, -0.36031346070627496, -0.7097370431606547],
                [-0.6612064329575712, 0.36031346070627496, -0.7097370431606547],
                [1.4142135623730951, 0.0, 0.2997778728622828],
                [-1.4142135623730951, 0.0, 0.2997778728622828],
                [0.0, 1.4142135623730951, -0.2997778728622828],
                [0.0, -1.4142135623730951, -0.2997778728622828],
            ],
        ),
        (
            "vertices-2",
            [
                [1.0319461686459552, 0.0, 0.849896254802118],
                [-1.0319461686459552, 0.0, 0.849896254802118],
                [0.0, 1.0319461686459552, -0.849896254802118],
                [0.0, -1.0319461686459552, -0.849896254802118],
                [0.0, 0.6128777741368966, 0.849896254802118],
                [0.0, -0.6128777741368966, 0.849896254802118],
                [0.6128777741368966, 0.0, -0.849896254802118],
                [-0.6128777741368966, 0.0, -0.849896254802118],
                [0.35117509897932175, -0.9424737448242083, 0.3589781509551674],
                [-0.35117509897932175, 0.9424737448242083, 0.3589781509551674],
                [0.9424737448242083, 0.35117509897932175, -0.3589781509551674],
                [-0.9424737448242083, -0.35117509897932175, -0.3589781509551674],
            ],
        ),
    ],
    "S6": [
        (
            "vertices",
            [
                [-0.958349120310194, 0.34009063223380526, 0.6335500762631686],
                [0.958349120310194, -0.34009063223380526, -0.6335500762631686],
                [0.7737016872586833, -0.27456455106360317, 0.6335500762631686],
                [-0.7737016872586833, 0.27456455106360317, -0.6335500762631686],
                [0.7737016872586833, 0.6599093677661948, 0.6335500762631686],
                [-0.7737016872586833, -0.6599093677661948, -0.6335500762631686],
                [-0.6246307198290917, -0.532763040585101, 0.6335500762631686],
                [0.6246307198290917, 0.532763040585101, -0.6335500762631686],
                [0.18464743305151082, -1.0, 0.6335500762631686],
                [-0.18464743305151082, 1.0, -0.6335500762631686],
                [-0.14907096742959158, 0.8073275916487042, 0.6335500762631686],
                [0.14907096742959158, -0.8073275916487042, -0.6335500762631686],
                [-0.8980735108232236, -0.44449105032241876, 0.21992269616711307],
                [0.8980735108232236, 0.44449105032241876, -0.21992269616711307],
                [0.8339772967456537, -0.5555089496775812, 0.21992269616711307],
                [-0.8339772967456537, 0.5555089496775812, -0.21992269616711307],
                [0.06409621407756987, 1.0, 0.21992269616711307],
                [-0.06409621407756987, -1.0, -0.21992269616711307],
            ],
        ),
        (
            "vertices-2",
            [
                [0.0, 0.0, 1.5784071969468327],
                [0.0, 0.0, -1.5784071969468327],
                [-0.8364985495055208, -0.31981873553238954, 0.48474417163591016],
                [0.8364985495055208, 0.31981873553238954, -0.48474417163591016],
                [0.6952204243300266, -0.5645196263344211, 0.48474417163591016],
                [-0.6952204243300266, 0.5645196263344211, -0.48474417163591016],
                [0.14127812517549415, 0.8843383618668106, 0.48474417163591016],
                [-0.14127812517549415, -0.8843383618668106, -0.48474417163591016],
                [1.1547005383792515, 0.0, 0.16826806462758645],
                [-1.1547005383792515, 0.0, -0.16826806462758645],
                [-0.5773502691896257, 1.0, 0.16826806462758645],
                [0.5773502691896257, 1.0, -0.16826806462758645],
                [-0.5773502691896257, -1.0, 0.16826806462758645],
                [0.5773502691896257, -1.0, -0.16826806462758645],
            ],
        ),
    ],
    "D2": [
        (
            "vertices",
            [
                [0.0, 0.0, 1.2078882314892923],
                [0.0, 0.0, -1.2078882314892923],
                [0.20678349452781558, -0.8278911690090963, 0.6297684119865748],
                [0.20678349452781558, 0.8278911690090963, -0.6297684119865748],
                [-0.20678349452781558, 0.8278911690090963, 0.6297684119865748],
                [-0.20678349452781558, -0.8278911690090963, -0.6297684119865748],
                [1.0, 0.8278911690090963, 0.3283484699963385],
                [1.0, -0.8278911690090963, -0.3283484699963385],
                [-1.0, -0.8278911690090963, 0.3283484699963385],
                [-1.0, 0.8278911690090963, -0.3283484699963385],
            ],
        )
    ],
    "D3": [
        (
            "vertices",
            [
                [0.0, 0.0, 1.1491020339707478],
                [0.21163171332200198, 0.24385641862467136, -1.0],
                [-0.21163171332200198, -0.24385641862467136, -1.0],
                [0.21163171332200198, 0.744097194472103, 0.7111858534048582],
                [-0.21163171332200198, -0.744097194472103, 0.7111858534048582],
                [0.0, 0.9951515529590366, -0.5745510169853739],
                [0.0, -0.9951515529590366, -0.5745510169853739],
                [0.21163171332200198, -0.9879536130967743, 0.2888141465951419],
                [-0.21163171332200198, 0.9879536130967743, 0.2888141465951419],
                [2.029963793177167, 0.0, 0.0],
                [-2.029963793177167, 0.0, 0.0],
            ],
        ),
        (
            "vertices-2",
            [
                [0.492619623739626, 0.4275217998199103, 1.0],
                [-0.492619623739626, -0.4275217998199103, 1.0],
                [0.492619623739626, 0.6522645038744835, -0.8702447393156878],
                [-0.492619623739626, -0.6522645038744835, -0.8702447393156878],
                [0.492619623739626, -0.3720485972360515, -0.8702447393156878],
                [-0.492619623739626, 0.3720485972360515, -0.8702447393156878],
                [0.492619623739626, -0.5676297531391263, 0.7573259063066293],
                [-0.492619623739626, 0.5676297531391263, 0.7573259063066293],
                [0.492619623739626, -1.0797863036943938, -0.12975526068431223],
                [-0.492619623739626, 1.0797863036943938, -0.12975526068431223],
                [0.492619623739626, 0.9396783503751778, 0.11291883300905842],
                [-0.492619623739626, -0.9396783503751778, 0.11291883300905842],
            ],
        ),
    ],
    "D2d": [
        (
            "vertices",
            [
                [1.0, 0.0, 1.0],
                [-1.0, 0.0, 1.0],
                [0.0, 1.0, -1.0],
                [0.0, -1.0, -1.0],
                [1.0, 0.0, -0.5],
                [-1.0, 0.0, -0.5],
                [0.0, 1.0, 0.5],
                [0.0, -1.0, 0.5],
            ],
        ),
        (
            "vertices-2",
            [
                [0.5, 0.0, 1.0],
                [-0.5, 0.0, 1.0],
                [0.0, 0.5, -1.0],
                [0.0, -0.5, -1.0],
                [1.0, 1.0, 0.0],
                [1.0, -1.0, 0.0],
                [-1.0, 1.0, 0.0],
                [-1.0, -1.0, 0.0],
            ],
        ),
    ],
    "D3d": [
        (
            "vertices",
            [
                [0.0, 0.0, 1.4142135623730951],
                [0.0, 0.0, -1.4142135623730951],
                [1.4142135623730951, 0.0, 0.0],
                [-1.4142135623730951, 0.0, 0.0],
                [0.0, 1.4142135623730951, 0.0],
                [0.0, -1.4142135623730951, 0.0],
                [0.585786437626905, 0.585786437626905, 0.585786437626905],
                [-0.585786437626905, -0.585786437626905, -0.585786437626905],
            ],
        ),
        (
            "vertices-2",
            [
                [0.7071067811865476, 0.7071067811865476, 0.7071067811865476],
                [-0.7071067811865476, -0.7071067811865476, -0.7071067811865476],
                [0.7071067811865476, -0.7071067811865476, 0.7071067811865476],
                [0.7071067811865476, -0.7071067811865476, -0.7071067811865476],
                [-0.7071067811865476, 0.7071067811865476, 0.7071067811865476],
                [-0.7071067811865476, 0.7071067811865476, -0.7071067811865476],
                [-0.7071067811865476, -0.2928932188134525, 0.7071067811865476],
                [0.7071067811865476, 0.2928932188134525, -0.7071067811865476],
                [-0.2928932188134525, -0.7071067811865476, 0.7071067811865476],
                [0.2928932188134525, 0.7071067811865476, -0.7071067811865476],
                [-0.7071067811865476, -0.7071067811865476, 0.2928932188134525],
                [0.7071067811865476, 0.7071067811865476, -0.2928932188134525],
            ],
        ),
    ],
    "D4d": [
        (
            "Square Antiprism vertices",
            [
                [0.7653668647301796, 0.7653668647301796, 0.6435942529055826],
                [0.7653668647301796, -0.7653668647301796, 0.6435942529055826],
                [-0.7653668647301796, 0.7653668647301796, 0.6435942529055826],
                [-0.7653668647301796, -0.7653668647301796, 0.6435942529055826],
                [1.082392200292394, 0.0, -0.6435942529055826],
                [-1.082392200292394, 0.0, -0.6435942529055826],
                [0.0, 1.082392200292394, -0.6435942529055826],
                [0.0, -1.082392200292394, -0.6435942529055826],
            ],
        ),
        (
            "Tetragonal Trapezohedron vertices",
            [
                [0.0, 0.0, 1.5537739740300374],
                [0.0, 0.0, -1.5537739740300374],
                [1.082392200292394, 0.0, 0.2665854682188721],
                [-1.082392200292394, 0.0, 0.2665854682188721],
                [0.0, 1.082392200292394, 0.2665854682188721],
                [0.0, -1.082392200292394, 0.2665854682188721],
                [0.7653668647301796, 0.7653668647301796, -0.2665854682188721],
                [0.7653668647301796, -0.7653668647301796, -0.2665854682188721],
                [-0.7653668647301796, 0.7653668647301796, -0.2665854682188721],
                [-0.7653668647301796, -0.7653668647301796, -0.2665854682188721],
            ],
        ),
    ],
    "D5d": [
        (
            "Pentagonal Antiprism vertices",
            [
                [0.6180339887498949, 0.0, 1.0],
                [0.6180339887498949, 0.0, -1.0],
                [-0.6180339887498949, 0.0, 1.0],
                [-0.6180339887498949, 0.0, -1.0],
                [0.0, 1.0, 0.6180339887498949],
                [0.0, 1.0, -0.6180339887498949],
                [0.0, -1.0, 0.6180339887498949],
                [0.0, -1.0, -0.6180339887498949],
                [1.0, 0.6180339887498949, 0.0],
                [-1.0, -0.6180339887498949, 0.0],
            ],
        ),
        (
            "Pentagonal Trapezohedron vertices",
            [
                [0.0, 0.38196601125010515, 1.0],
                [0.0, 0.38196601125010515, -1.0],
                [0.0, -0.38196601125010515, 1.0],
                [0.0, -0.38196601125010515, -1.0],
                [0.6180339887498949, 0.6180339887498949, 0.6180339887498949],
                [0.6180339887498949, 0.6180339887498949, -0.6180339887498949],
                [-0.6180339887498949, -0.6180339887498949, 0.6180339887498949],
                [-0.6180339887498949, -0.6180339887498949, -0.6180339887498949],
                [1.618033988749895, -1.0, 0.0],
                [-1.618033988749895, 1.0, 0.0],
                [0.38196601125010515, 1.0, 0.0],
                [-0.38196601125010515, -1.0, 0.0],
            ],
        ),
    ],
    "D6d": [
        (
            "Hexagonal Antiprism vertices",
            [
                [1.035276180410083, 0.0, 0.4428909828689583],
                [-1.035276180410083, 0.0, 0.4428909828689583],
                [0.5176380902050415, 0.8965754721680536, 0.4428909828689583],
                [0.5176380902050415, -0.8965754721680536, 0.4428909828689583],
                [-0.5176380902050415, 0.8965754721680536, 0.4428909828689583],
                [-0.5176380902050415, -0.8965754721680536, 0.4428909828689583],
                [0.8965754721680536, 0.5176380902050415, -0.4428909828689583],
                [0.8965754721680536, -0.5176380902050415, -0.4428909828689583],
                [-0.8965754721680536, 0.5176380902050415, -0.4428909828689583],
                [-0.8965754721680536, -0.5176380902050415, -0.4428909828689583],
                [0.0, 1.035276180410083, -0.4428909828689583],
                [0.0, -1.035276180410083, -0.4428909828689583],
            ],
        ),
        (
            "Hexagonal Trapezohedron",
            [
                [0.0, 0.0, 2.257891983987125],
                [0.0, 0.0, -2.257891983987125],
                [0.0, 1.035276180410083, 0.16210935083709735],
                [0.0, -1.035276180410083, 0.16210935083709735],
                [1.035276180410083, 0.0, -0.16210935083709735],
                [-1.035276180410083, 0.0, -0.16210935083709735],
                [0.8965754721680536, 0.5176380902050415, 0.16210935083709735],
                [0.8965754721680536, -0.5176380902050415, 0.16210935083709735],
                [-0.8965754721680536, 0.5176380902050415, 0.16210935083709735],
                [-0.8965754721680536, -0.5176380902050415, 0.16210935083709735],
                [0.5176380902050415, 0.8965754721680536, -0.16210935083709735],
                [0.5176380902050415, -0.8965754721680536, -0.16210935083709735],
                [-0.5176380902050415, 0.8965754721680536, -0.16210935083709735],
                [-0.5176380902050415, -0.8965754721680536, -0.16210935083709735],
            ],
        ),
    ],
    "T": [
        (
            "Propello Tetrahedron",
            [
                [0.5097553324933856, 0.13968058199610653, 1.0],
                [0.5097553324933856, -0.13968058199610653, -1.0],
                [-0.5097553324933856, -0.13968058199610653, 1.0],
                [-0.5097553324933856, 0.13968058199610653, -1.0],
                [1.0, 0.5097553324933856, 0.13968058199610653],
                [1.0, -0.5097553324933856, -0.13968058199610653],
                [-1.0, -0.5097553324933856, 0.13968058199610653],
                [-1.0, 0.5097553324933856, -0.13968058199610653],
                [0.13968058199610653, 1.0, 0.5097553324933856],
                [0.13968058199610653, -1.0, -0.5097553324933856],
                [-0.13968058199610653, -1.0, 0.5097553324933856],
                [-0.13968058199610653, 1.0, -0.5097553324933856],
                [0.6062678708614785, -0.6062678708614785, 0.6062678708614785],
                [0.6062678708614785, 0.6062678708614785, -0.6062678708614785],
                [-0.6062678708614785, 0.6062678708614785, 0.6062678708614785],
                [-0.6062678708614785, -0.6062678708614785, -0.6062678708614785],
            ],
        )
    ],
    "Th": [
        (
            "vertices",
            [
                [0.41421356237309503, 0.0, 1.0],
                [0.41421356237309503, 0.0, -1.0],
                [-0.41421356237309503, 0.0, 1.0],
                [-0.41421356237309503, 0.0, -1.0],
                [1.0, 0.41421356237309503, 0.0],
                [1.0, -0.41421356237309503, 0.0],
                [-1.0, 0.41421356237309503, 0.0],
                [-1.0, -0.41421356237309503, 0.0],
                [0.0, 1.0, 0.41421356237309503],
                [0.0, 1.0, -0.41421356237309503],
                [0.0, -1.0, 0.41421356237309503],
                [0.0, -1.0, -0.41421356237309503],
                [0.0, 0.5224077499274828, 0.8918058124456122],
                [0.0, 0.5224077499274828, -0.8918058124456122],
                [0.0, -0.5224077499274828, 0.8918058124456122],
                [0.0, -0.5224077499274828, -0.8918058124456122],
                [0.8918058124456122, 0.0, 0.5224077499274828],
                [0.8918058124456122, 0.0, -0.5224077499274828],
                [-0.8918058124456122, 0.0, 0.5224077499274828],
                [-0.8918058124456122, 0.0, -0.5224077499274828],
                [0.5224077499274828, 0.8918058124456122, 0.0],
                [0.5224077499274828, -0.8918058124456122, 0.0],
                [-0.5224077499274828, 0.8918058124456122, 0.0],
                [-0.5224077499274828, -0.8918058124456122, 0.0],
            ],
        ),
        (
            "vertices-2",
            [
                [0.20710678118654752, 0.0, 1.0],
                [0.20710678118654752, 0.0, -1.0],
                [-0.20710678118654752, 0.0, 1.0],
                [-0.20710678118654752, 0.0, -1.0],
                [1.0, 0.20710678118654752, 0.0],
                [1.0, -0.20710678118654752, 0.0],
                [-1.0, 0.20710678118654752, 0.0],
                [-1.0, -0.20710678118654752, 0.0],
                [0.0, 1.0, 0.20710678118654752],
                [0.0, 1.0, -0.20710678118654752],
                [0.0, -1.0, 0.20710678118654752],
                [0.0, -1.0, -0.20710678118654752],
                [0.7071067811865476, 0.7071067811865476, 0.7071067811865476],
                [0.7071067811865476, 0.7071067811865476, -0.7071067811865476],
                [0.7071067811865476, -0.7071067811865476, 0.7071067811865476],
                [0.7071067811865476, -0.7071067811865476, -0.7071067811865476],
                [-0.7071067811865476, 0.7071067811865476, 0.7071067811865476],
                [-0.7071067811865476, 0.7071067811865476, -0.7071067811865476],
                [-0.7071067811865476, -0.7071067811865476, 0.7071067811865476],
                [-0.7071067811865476, -0.7071067811865476, -0.7071067811865476],
            ],
        ),
    ],
    "Td": ["PlatonicFamily.Tetrahedron"],
    "O": [
        "ArchimedeanFamily.Snub Cuboctahedron",
        "CatalanFamily.Pentagonal Icositetrahedron",
        (
            "Propello Cube vertices",
            [
                [0.48168987641083044, 0.1696290458678061, 0.9325236859622646],
                [0.48168987641083044, -0.1696290458678061, -0.9325236859622646],
                [-0.48168987641083044, -0.1696290458678061, 0.9325236859622646],
                [-0.48168987641083044, 0.1696290458678061, -0.9325236859622646],
                [0.9325236859622646, 0.48168987641083044, 0.1696290458678061],
                [0.9325236859622646, -0.48168987641083044, -0.1696290458678061],
                [-0.9325236859622646, -0.48168987641083044, 0.1696290458678061],
                [-0.9325236859622646, 0.48168987641083044, -0.1696290458678061],
                [0.1696290458678061, 0.9325236859622646, 0.48168987641083044],
                [0.1696290458678061, -0.9325236859622646, -0.48168987641083044],
                [-0.1696290458678061, -0.9325236859622646, 0.48168987641083044],
                [-0.1696290458678061, 0.9325236859622646, -0.48168987641083044],
                [0.1696290458678061, -0.48168987641083044, 0.9325236859622646],
                [0.1696290458678061, 0.48168987641083044, -0.9325236859622646],
                [-0.1696290458678061, 0.48168987641083044, 0.9325236859622646],
                [-0.1696290458678061, -0.48168987641083044, -0.9325236859622646],
                [0.9325236859622646, -0.1696290458678061, 0.48168987641083044],
                [0.9325236859622646, 0.1696290458678061, -0.48168987641083044],
                [-0.9325236859622646, 0.1696290458678061, 0.48168987641083044],
                [-0.9325236859622646, -0.1696290458678061, -0.48168987641083044],
                [0.48168987641083044, -0.9325236859622646, 0.1696290458678061],
                [0.48168987641083044, 0.9325236859622646, -0.1696290458678061],
                [-0.48168987641083044, 0.9325236859622646, 0.1696290458678061],
                [-0.48168987641083044, -0.9325236859622646, -0.1696290458678061],
                [0.5878005115037175, 0.5878005115037175, 0.5878005115037175],
                [0.5878005115037175, 0.5878005115037175, -0.5878005115037175],
                [0.5878005115037175, -0.5878005115037175, 0.5878005115037175],
                [0.5878005115037175, -0.5878005115037175, -0.5878005115037175],
                [-0.5878005115037175, 0.5878005115037175, 0.5878005115037175],
                [-0.5878005115037175, 0.5878005115037175, -0.5878005115037175],
                [-0.5878005115037175, -0.5878005115037175, 0.5878005115037175],
                [-0.5878005115037175, -0.5878005115037175, -0.5878005115037175],
            ],
        ),
        (
            "Propello Octahedron vertices",
            [
                [0.0, 0.0, 1.0723588205355954],
                [0.0, 0.0, -1.0723588205355954],
                [1.0723588205355954, 0.0, 0.0],
                [-1.0723588205355954, 0.0, 0.0],
                [0.0, 1.0723588205355954, 0.0],
                [0.0, -1.0723588205355954, 0.0],
                [0.5991047193446304, -0.2870438888016061, 0.8151088430284646],
                [0.5991047193446304, 0.2870438888016061, -0.8151088430284646],
                [-0.5991047193446304, 0.2870438888016061, 0.8151088430284646],
                [-0.5991047193446304, -0.2870438888016061, -0.8151088430284646],
                [0.8151088430284646, -0.5991047193446304, 0.2870438888016061],
                [0.8151088430284646, 0.5991047193446304, -0.2870438888016061],
                [-0.8151088430284646, 0.5991047193446304, 0.2870438888016061],
                [-0.8151088430284646, -0.5991047193446304, -0.2870438888016061],
                [0.2870438888016061, -0.8151088430284646, 0.5991047193446304],
                [0.2870438888016061, 0.8151088430284646, -0.5991047193446304],
                [-0.2870438888016061, 0.8151088430284646, 0.5991047193446304],
                [-0.2870438888016061, -0.8151088430284646, -0.5991047193446304],
                [0.2870438888016061, 0.5991047193446304, 0.8151088430284646],
                [0.2870438888016061, -0.5991047193446304, -0.8151088430284646],
                [-0.2870438888016061, -0.5991047193446304, 0.8151088430284646],
                [-0.2870438888016061, 0.5991047193446304, -0.8151088430284646],
                [0.8151088430284646, 0.2870438888016061, 0.5991047193446304],
                [0.8151088430284646, -0.2870438888016061, -0.5991047193446304],
                [-0.8151088430284646, -0.2870438888016061, 0.5991047193446304],
                [-0.8151088430284646, 0.2870438888016061, -0.5991047193446304],
                [0.5991047193446304, 0.8151088430284646, 0.2870438888016061],
                [0.5991047193446304, -0.8151088430284646, -0.2870438888016061],
                [-0.5991047193446304, -0.8151088430284646, 0.2870438888016061],
                [-0.5991047193446304, 0.8151088430284646, -0.2870438888016061],
            ],
        ),
    ],
    "Oh": ["PlatonicFamily.Octahedron", "PlatonicFamily.Cube"],
    "I": [
        "ArchimedeanFamily.Snub Icosidodecahedron",
        "CatalanFamily.Pentagonal Hexecontahedron",
        (
            "Propello Dodecahedron vertices",
            [
                [0.1951284563056969, -0.10070091801974525, 1.0],
                [0.1951284563056969, 0.10070091801974525, -1.0],
                [-0.1951284563056969, 0.10070091801974525, 1.0],
                [-0.1951284563056969, -0.10070091801974525, -1.0],
                [1.0, -0.1951284563056969, 0.10070091801974525],
                [1.0, 0.1951284563056969, -0.10070091801974525],
                [-1.0, 0.1951284563056969, 0.10070091801974525],
                [-1.0, -0.1951284563056969, -0.10070091801974525],
                [0.10070091801974525, -1.0, 0.1951284563056969],
                [0.10070091801974525, 1.0, -0.1951284563056969],
                [-0.10070091801974525, 1.0, 0.1951284563056969],
                [-0.10070091801974525, -1.0, -0.1951284563056969],
                [0.0, 0.3589611999956875, 0.9397726222311584],
                [0.0, 0.3589611999956875, -0.9397726222311584],
                [0.0, -0.3589611999956875, 0.9397726222311584],
                [0.0, -0.3589611999956875, -0.9397726222311584],
                [0.9397726222311584, 0.0, 0.3589611999956875],
                [0.9397726222311584, 0.0, -0.3589611999956875],
                [-0.9397726222311584, 0.0, 0.3589611999956875],
                [-0.9397726222311584, 0.0, -0.3589611999956875],
                [0.3589611999956875, 0.9397726222311584, 0.0],
                [0.3589611999956875, -0.9397726222311584, 0.0],
                [-0.3589611999956875, 0.9397726222311584, 0.0],
                [-0.3589611999956875, -0.9397726222311584, 0.0],
                [0.3251124685006636, 0.31101946774528216, 0.9196654624694297],
                [0.3251124685006636, -0.31101946774528216, -0.9196654624694297],
                [-0.3251124685006636, -0.31101946774528216, 0.9196654624694297],
                [-0.3251124685006636, 0.31101946774528216, -0.9196654624694297],
                [0.9196654624694297, 0.3251124685006636, 0.31101946774528216],
                [0.9196654624694297, -0.3251124685006636, -0.31101946774528216],
                [-0.9196654624694297, -0.3251124685006636, 0.31101946774528216],
                [-0.9196654624694297, 0.3251124685006636, -0.31101946774528216],
                [0.31101946774528216, 0.9196654624694297, 0.3251124685006636],
                [0.31101946774528216, -0.9196654624694297, -0.3251124685006636],
                [-0.31101946774528216, -0.9196654624694297, 0.3251124685006636],
                [-0.31101946774528216, 0.9196654624694297, -0.3251124685006636],
                [0.48804997655492816, -0.37325605777980153, 0.8189645444496845],
                [0.48804997655492816, 0.37325605777980153, -0.8189645444496845],
                [-0.48804997655492816, 0.37325605777980153, 0.8189645444496845],
                [-0.48804997655492816, -0.37325605777980153, -0.8189645444496845],
                [0.8189645444496845, -0.48804997655492816, 0.37325605777980153],
                [0.8189645444496845, 0.48804997655492816, -0.37325605777980153],
                [-0.8189645444496845, 0.48804997655492816, 0.37325605777980153],
                [-0.8189645444496845, -0.48804997655492816, -0.37325605777980153],
                [0.37325605777980153, -0.8189645444496845, 0.48804997655492816],
                [0.37325605777980153, 0.8189645444496845, -0.48804997655492816],
                [-0.37325605777980153, 0.8189645444496845, 0.48804997655492816],
                [-0.37325605777980153, -0.8189645444496845, -0.48804997655492816],
                [0.1299840121949667, -0.6267439422201985, 0.7990694443002103],
                [0.1299840121949667, 0.6267439422201985, -0.7990694443002103],
                [-0.1299840121949667, 0.6267439422201985, 0.7990694443002103],
                [-0.1299840121949667, -0.6267439422201985, -0.7990694443002103],
                [0.7990694443002103, -0.1299840121949667, 0.6267439422201985],
                [0.7990694443002103, 0.1299840121949667, -0.6267439422201985],
                [-0.7990694443002103, 0.1299840121949667, 0.6267439422201985],
                [-0.7990694443002103, -0.1299840121949667, -0.6267439422201985],
                [0.6267439422201985, -0.7990694443002103, 0.1299840121949667],
                [0.6267439422201985, 0.7990694443002103, -0.1299840121949667],
                [-0.6267439422201985, 0.7990694443002103, 0.1299840121949667],
                [-0.6267439422201985, -0.7990694443002103, -0.1299840121949667],
                [0.29292152024923124, 0.6889805322547178, 0.6983685262804651],
                [0.29292152024923124, -0.6889805322547178, -0.6983685262804651],
                [-0.29292152024923124, -0.6889805322547178, 0.6983685262804651],
                [-0.29292152024923124, 0.6889805322547178, -0.6983685262804651],
                [0.6983685262804651, 0.29292152024923124, 0.6889805322547178],
                [0.6983685262804651, -0.29292152024923124, -0.6889805322547178],
                [-0.6983685262804651, -0.29292152024923124, 0.6889805322547178],
                [-0.6983685262804651, 0.29292152024923124, -0.6889805322547178],
                [0.6889805322547178, 0.6983685262804651, 0.29292152024923124],
                [0.6889805322547178, -0.6983685262804651, -0.29292152024923124],
                [-0.6889805322547178, -0.6983685262804651, 0.29292152024923124],
                [-0.6889805322547178, 0.6983685262804651, -0.29292152024923124],
                [0.5808114222354709, 0.5808114222354709, 0.5808114222354709],
                [0.5808114222354709, 0.5808114222354709, -0.5808114222354709],
                [0.5808114222354709, -0.5808114222354709, 0.5808114222354709],
                [0.5808114222354709, -0.5808114222354709, -0.5808114222354709],
                [-0.5808114222354709, 0.5808114222354709, 0.5808114222354709],
                [-0.5808114222354709, 0.5808114222354709, -0.5808114222354709],
                [-0.5808114222354709, -0.5808114222354709, 0.5808114222354709],
                [-0.5808114222354709, -0.5808114222354709, -0.5808114222354709],
            ],
        ),
        (
            "Propello Icosahedron vertices",
            [
                [0.08658831082961818, 0.16778241706782004, 1.0],
                [0.08658831082961818, -0.16778241706782004, -1.0],
                [-0.08658831082961818, -0.16778241706782004, 1.0],
                [-0.08658831082961818, 0.16778241706782004, -1.0],
                [1.0, 0.08658831082961818, 0.16778241706782004],
                [1.0, -0.08658831082961818, -0.16778241706782004],
                [-1.0, -0.08658831082961818, 0.16778241706782004],
                [-1.0, 0.08658831082961818, -0.16778241706782004],
                [0.16778241706782004, 1.0, 0.08658831082961818],
                [0.16778241706782004, -1.0, -0.08658831082961818],
                [-0.16778241706782004, -1.0, 0.08658831082961818],
                [-0.16778241706782004, 1.0, -0.08658831082961818],
                [0.21657232302458487, -0.378100966793357, 0.9196654624694297],
                [0.21657232302458487, 0.378100966793357, -0.9196654624694297],
                [-0.21657232302458487, 0.378100966793357, 0.9196654624694297],
                [-0.21657232302458487, -0.378100966793357, -0.9196654624694297],
                [0.9196654624694297, -0.21657232302458487, 0.378100966793357],
                [0.9196654624694297, 0.21657232302458487, -0.378100966793357],
                [-0.9196654624694297, 0.21657232302458487, 0.378100966793357],
                [-0.9196654624694297, -0.21657232302458487, -0.378100966793357],
                [0.378100966793357, -0.9196654624694297, 0.21657232302458487],
                [0.378100966793357, 0.9196654624694297, -0.21657232302458487],
                [-0.378100966793357, 0.9196654624694297, 0.21657232302458487],
                [-0.378100966793357, -0.9196654624694297, -0.21657232302458487],
                [0.5515225636439541, 0.0, 0.8923822535383947],
                [0.5515225636439541, 0.0, -0.8923822535383947],
                [-0.5515225636439541, 0.0, 0.8923822535383947],
                [-0.5515225636439541, 0.0, -0.8923822535383947],
                [0.8923822535383947, 0.5515225636439541, 0.0],
                [0.8923822535383947, -0.5515225636439541, 0.0],
                [-0.8923822535383947, 0.5515225636439541, 0.0],
                [-0.8923822535383947, -0.5515225636439541, 0.0],
                [0.0, 0.8923822535383947, 0.5515225636439541],
                [0.0, 0.8923822535383947, -0.5515225636439541],
                [0.0, -0.8923822535383947, 0.5515225636439541],
                [0.0, -0.8923822535383947, -0.5515225636439541],
                [0.1299840121949667, 0.5182037967441198, 0.8661509433482851],
                [0.1299840121949667, -0.5182037967441198, -0.8661509433482851],
                [-0.1299840121949667, -0.5182037967441198, 0.8661509433482851],
                [-0.1299840121949667, 0.5182037967441198, -0.8661509433482851],
                [0.8661509433482851, 0.1299840121949667, 0.5182037967441198],
                [0.8661509433482851, -0.1299840121949667, -0.5182037967441198],
                [-0.8661509433482851, -0.1299840121949667, 0.5182037967441198],
                [-0.8661509433482851, 0.1299840121949667, -0.5182037967441198],
                [0.5182037967441198, 0.8661509433482851, 0.1299840121949667],
                [0.5182037967441198, -0.8661509433482851, -0.1299840121949667],
                [-0.5182037967441198, -0.8661509433482851, 0.1299840121949667],
                [-0.5182037967441198, 0.8661509433482851, -0.1299840121949667],
                [0.48804997655492816, 0.48179620325588024, 0.7518830454016098],
                [0.48804997655492816, -0.48179620325588024, -0.7518830454016098],
                [-0.48804997655492816, -0.48179620325588024, 0.7518830454016098],
                [-0.48804997655492816, 0.48179620325588024, -0.7518830454016098],
                [0.7518830454016098, 0.48804997655492816, 0.48179620325588024],
                [0.7518830454016098, -0.48804997655492816, -0.48179620325588024],
                [-0.7518830454016098, -0.48804997655492816, 0.48179620325588024],
                [-0.7518830454016098, 0.48804997655492816, -0.48179620325588024],
                [0.48179620325588024, 0.7518830454016098, 0.48804997655492816],
                [0.48179620325588024, -0.7518830454016098, -0.48804997655492816],
                [-0.48179620325588024, -0.7518830454016098, 0.48804997655492816],
                [-0.48179620325588024, 0.7518830454016098, -0.48804997655492816],
                [0.40146166572531, -0.6218990332066431, 0.6983685262804651],
                [0.40146166572531, 0.6218990332066431, -0.6983685262804651],
                [-0.40146166572531, 0.6218990332066431, 0.6983685262804651],
                [-0.40146166572531, -0.6218990332066431, -0.6983685262804651],
                [0.6983685262804651, -0.40146166572531, 0.6218990332066431],
                [0.6983685262804651, 0.40146166572531, -0.6218990332066431],
                [-0.6983685262804651, 0.40146166572531, 0.6218990332066431],
                [-0.6983685262804651, -0.40146166572531, -0.6218990332066431],
                [0.6218990332066431, -0.6983685262804651, 0.40146166572531],
                [0.6218990332066431, 0.6983685262804651, -0.40146166572531],
                [-0.6218990332066431, 0.6983685262804651, 0.40146166572531],
                [-0.6218990332066431, -0.6983685262804651, -0.40146166572531],
            ],
        ),
    ],
    "Ih": ["PlatonicFamily.Icosahedron", "PlatonicFamily.Dodecahedron"],
}
shape_symmetries.update({f"C{n}v": [get_pyramid(n)] for n in range(3, 13)})
shape_symmetries.update({f"D{n}h": [get_bipyramid(n)] for n in range(3, 13)})
shape_symmetries.update(
    {f"D{n}h": [f"PrismAntiprismFamily.{n_dict[n]} Prism"] for n in range(3, 11)}
)
shape_symmetries.update(
    {f"D{n}d": [f"PrismAntiprismFamily.{n_dict[n]} Antiprism"] for n in range(3, 11)}
)


@pytest.mark.parametrize(
    "symmetry, shape, vertices",
    (
        (sym, shape, vertices)
        for sym, shapes in shape_symmetries.items()
        for shape, vertices in map(parse_shape_values, shapes)
    ),
    ids=_id_func,
)
def test_symmetries(symmetry, shape, vertices):
    op = check_symmetry(symmetry=symmetry, vertices=vertices)
    assert op >= cutoff


non_shape_symmetries = {
    "O": ["PlatonicFamily.Tetrahedron", "PlatonicFamily.Icosahedron"],
    "Oh": ["PlatonicFamily.Tetrahedron", "PlatonicFamily.Icosahedron"],
    "T": [get_pyramid(5), get_bipyramid(5)],
    "I": ["PlatonicFamily.Octahedron"],
    "Ih": ["PlatonicFamily.Octahedron"],
}
# Symmetries are carefully chosen here as due to rotations and partial ordering
# meeting the threshold can be difficult here.
cyclic_non_symmetry = {
    2: 3,
    3: 4,
    4: 5,
    5: 3,
    6: 3,
    7: 4,
    8: 3,
    9: 4,
    10: 4,
    11: 5,
    12: 5,
}
non_shape_symmetries.update(
    {f"C{i}": [f"RegularNGonFamily.{cyclic_non_symmetry[i]}"] for i in range(3, 13)}
)
non_shape_symmetries.update({f"D{i}": [get_pyramid(i)] for i in range(3, 13)})
non_shape_symmetries.update(
    {f"D{i}": [get_bipyramid(cyclic_non_symmetry[i])] for i in range(3, 13)}
)


@pytest.mark.parametrize(
    "symmetry, shape, vertices",
    (
        (sym, shape, vertices)
        for sym, shapes in non_shape_symmetries.items()
        for shape, vertices in map(parse_shape_values, shapes)
    ),
    ids=_id_func,
)
def test_no_symmetries(symmetry, shape, vertices):
    op = check_symmetry(symmetry=symmetry, vertices=vertices)
    assert op < 0.8
